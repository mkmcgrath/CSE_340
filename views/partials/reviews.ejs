<section class="reviews-section">
  <h2>Customer Reviews</h2>

  <% if (avgRating && reviewCount > 0) { %>
    <div class="rating-summary">
      <p class="average-rating">
        Average Rating: <strong><%= parseFloat(avgRating).toFixed(1) %></strong> / 5.0
        (<%= reviewCount %> <%= reviewCount === 1 ? 'review' : 'reviews' %>)
      </p>
    </div>
  <% } else { %>
    <p>No reviews yet. Be the first to review this vehicle!</p>
  <% } %>

  <% if (reviews && reviews.length > 0) { %>
    <div class="reviews-list">
      <% reviews.forEach(review => { %>
        <div class="review-item">
          <div class="review-header">
            <span class="reviewer-name"><%= review.account_firstname %> <%= review.account_lastname.charAt(0) %>.</span>
            <span class="review-rating">
              <% for(let i = 1; i <= 5; i++) { %>
                <% if(i <= review.review_rating) { %>
                  &#9733;
                <% } else { %>
                  &#9734;
                <% } %>
              <% } %>
            </span>
            <span class="review-date"><%= new Date(review.review_date).toLocaleDateString() %></span>
          </div>
          <div class="review-text">
            <p><%= review.review_text %></p>
          </div>
          <% if (locals.accountData && locals.accountData.account_id === review.account_id) { %>
            <div class="review-actions">
              <a href="/review/edit/<%= review.review_id %>" class="btn-edit">Edit</a>
              <a href="/review/delete/<%= review.review_id %>" class="btn-delete">Delete</a>
            </div>
          <% } %>
        </div>
      <% }) %>
    </div>
  <% } %>
</section>
